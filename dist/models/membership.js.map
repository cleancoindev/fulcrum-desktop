{"version":3,"sources":["../../src/models/membership.js"],"names":["Membership","constructor","attributes","updateFromAPIAttributes","attrs","_id","id","_firstName","first_name","_lastName","last_name","_userID","user_id","_email","email","_roleID","role_id","tableName","columns","name","column","type","null","getLocalRole","_role","findFirst","db","resource_id","_roleRowID","rowID","getRole","loadOne","role","setOne","register"],"mappings":";;;;;;AAAA;;AACA;;;;;;;;AAEe,MAAMA,UAAN,CAAiB;AAC9BC,cAAYC,UAAZ,EAAwB;AACtB,SAAKC,uBAAL,CAA6BD,UAA7B;AACD;;AAEDC,0BAAwBC,KAAxB,EAA+B;AAC7B,UAAMF,aAAaE,SAAS,EAA5B;;AAEA,SAAKC,GAAL,GAAWH,WAAWI,EAAtB;AACA,SAAKC,UAAL,GAAkBL,WAAWM,UAA7B;AACA,SAAKC,SAAL,GAAiBP,WAAWQ,SAA5B;AACA,SAAKC,OAAL,GAAeT,WAAWU,OAA1B;AACA,SAAKC,MAAL,GAAcX,WAAWY,KAAzB;AACA,SAAKC,OAAL,GAAeb,WAAWc,OAA1B;AACD;;AAED,MAAIV,EAAJ,GAAS;AACP,WAAO,KAAKD,GAAZ;AACD;;AAED,aAAWY,SAAX,GAAuB;AACrB,WAAO,aAAP;AACD;;AAED,aAAWC,OAAX,GAAqB;AACnB,WAAO,CACL,EAAEC,MAAM,cAAR,EAAwBC,QAAQ,YAAhC,EAA8CC,MAAM,SAApD,EAA+DC,MAAM,KAArE,EADK,EAEL,EAAEH,MAAM,IAAR,EAAcC,QAAQ,aAAtB,EAAqCC,MAAM,QAA3C,EAAqDC,MAAM,KAA3D,EAFK,EAGL,EAAEH,MAAM,QAAR,EAAkBC,QAAQ,kBAA1B,EAA8CC,MAAM,QAApD,EAA8DC,MAAM,KAApE,EAHK,EAIL,EAAEH,MAAM,QAAR,EAAkBC,QAAQ,kBAA1B,EAA8CC,MAAM,QAApD,EAA8DC,MAAM,KAApE,EAJK,EAKL,EAAEH,MAAM,WAAR,EAAqBC,QAAQ,SAA7B,EAAwCC,MAAM,SAA9C,EAAyDC,MAAM,KAA/D,EALK,EAML,EAAEH,MAAM,OAAR,EAAiBC,QAAQ,OAAzB,EAAkCC,MAAM,QAAxC,EAAkDC,MAAM,KAAxD,EANK,EAOL,EAAEH,MAAM,WAAR,EAAqBC,QAAQ,YAA7B,EAA2CC,MAAM,QAAjD,EAA2DC,MAAM,KAAjE,EAPK,EAQL,EAAEH,MAAM,UAAR,EAAoBC,QAAQ,WAA5B,EAAyCC,MAAM,QAA/C,EAAyDC,MAAM,KAA/D,EARK,EASL,EAAEH,MAAM,WAAR,EAAqBC,QAAQ,YAA7B,EAA2CC,MAAM,UAAjD,EAA6DC,MAAM,KAAnE,EATK,EAUL,EAAEH,MAAM,WAAR,EAAqBC,QAAQ,YAA7B,EAA2CC,MAAM,UAAjD,EAA6DC,MAAM,KAAnE,EAVK,EAWL,EAAEH,MAAM,WAAR,EAAqBC,QAAQ,YAA7B,EAA2CC,MAAM,UAAjD,EAXK,CAAP;AAaD;;AAEKE,cAAN,GAAqB;AAAA;;AAAA;AACnB,YAAKC,KAAL,GAAa,MAAM,eAAKC,SAAL,CAAe,MAAKC,EAApB,EAAwB,EAACC,aAAa,MAAKZ,OAAnB,EAAxB,CAAnB;AACA,YAAKa,UAAL,GAAkB,MAAKJ,KAAL,GAAa,MAAKA,KAAL,CAAWK,KAAxB,GAAgC,IAAlD;AACA,aAAO,MAAKL,KAAZ;AAHmB;AAIpB;;AAED;AACAM,YAAU;AACR,WAAO,KAAKC,OAAL,CAAa,MAAb,iBAAP;AACD;;AAED,MAAIC,IAAJ,GAAW;AACT,WAAO,KAAKR,KAAZ;AACD;;AAED,MAAIQ,IAAJ,CAASA,IAAT,EAAe;AACb,SAAKC,MAAL,CAAY,MAAZ,EAAoBD,IAApB;AACD;AAzD6B;;kBAAXhC,U;AA4DrB,yBAAiBkC,QAAjB,CAA0BlC,UAA1B","file":"membership.js","sourcesContent":["import { PersistentObject } from 'minidb';\nimport Role from './role';\n\nexport default class Membership {\n  constructor(attributes) {\n    this.updateFromAPIAttributes(attributes);\n  }\n\n  updateFromAPIAttributes(attrs) {\n    const attributes = attrs || {};\n\n    this._id = attributes.id;\n    this._firstName = attributes.first_name;\n    this._lastName = attributes.last_name;\n    this._userID = attributes.user_id;\n    this._email = attributes.email;\n    this._roleID = attributes.role_id;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  static get tableName() {\n    return 'memberships';\n  }\n\n  static get columns() {\n    return [\n      { name: 'accountRowID', column: 'account_id', type: 'integer', null: false },\n      { name: 'id', column: 'resource_id', type: 'string', null: false },\n      { name: 'userID', column: 'user_resource_id', type: 'string', null: false },\n      { name: 'roleID', column: 'role_resource_id', type: 'string', null: false },\n      { name: 'roleRowID', column: 'role_id', type: 'integer', null: false },\n      { name: 'email', column: 'email', type: 'string', null: false },\n      { name: 'firstName', column: 'first_name', type: 'string', null: false },\n      { name: 'lastName', column: 'last_name', type: 'string', null: false },\n      { name: 'createdAt', column: 'created_at', type: 'datetime', null: false },\n      { name: 'updatedAt', column: 'updated_at', type: 'datetime', null: false },\n      { name: 'deletedAt', column: 'deleted_at', type: 'datetime' }\n    ];\n  }\n\n  async getLocalRole() {\n    this._role = await Role.findFirst(this.db, {resource_id: this._roleID});\n    this._roleRowID = this._role ? this._role.rowID : null;\n    return this._role;\n  }\n\n  // role\n  getRole() {\n    return this.loadOne('role', Role);\n  }\n\n  get role() {\n    return this._role;\n  }\n\n  set role(role) {\n    this.setOne('role', role);\n  }\n}\n\nPersistentObject.register(Membership);\n"]}