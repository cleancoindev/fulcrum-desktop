{"version":3,"sources":["../src/plugin.js"],"names":["Plugin","constructor","db","_db","fetchAccount","name","where","organization_name","accounts","findAll","createDataSource","account","dataSource","localDatabase","add","load"],"mappings":";;;;;;AAAA;;AACA;;;;AACA;;;;;;;;AAEe,MAAMA,MAAN,CAAa;AAC1BC,cAAY,EAACC,EAAD,EAAZ,EAAkB;AAChB,SAAKC,GAAL,GAAWD,EAAX;AACD;;AAED,MAAIA,EAAJ,GAAS;AACP,WAAO,KAAKC,GAAZ;AACD;;AAEKC,cAAN,CAAmBC,IAAnB,EAAyB;AAAA;;AAAA;AACvB,YAAMC,QAAQ,EAAd;;AAEA,UAAID,IAAJ,EAAU;AACRC,cAAMC,iBAAN,GAA0BF,IAA1B;AACD;;AAED,YAAMG,WAAW,MAAM,kBAAQC,OAAR,CAAgB,MAAKP,EAArB,EAAyBI,KAAzB,CAAvB;;AAEA,aAAOE,SAAS,CAAT,CAAP;AATuB;AAUxB;;AAEKE,kBAAN,CAAuBC,OAAvB,EAAgC;AAAA;;AAAA;AAC9B,UAAIC,aAAa,6BAAjB;;AAEA,YAAMC,gBAAgB,sCAA4BF,OAA5B,CAAtB;;AAEAC,iBAAWE,GAAX,CAAeD,aAAf;;AAEA,YAAMA,cAAcE,IAAd,CAAmB,OAAKb,EAAxB,CAAN;;AAEA,aAAOU,UAAP;AAT8B;AAU/B;AA/ByB;kBAAPZ,M","file":"plugin.js","sourcesContent":["import { DataSource } from 'fulcrum-core';\nimport Account from './models/account';\nimport LocalDatabaseDataSource from './local-database-data-source';\n\nexport default class Plugin {\n  constructor({db}) {\n    this._db = db;\n  }\n\n  get db() {\n    return this._db;\n  }\n\n  async fetchAccount(name) {\n    const where = {};\n\n    if (name) {\n      where.organization_name = name;\n    }\n\n    const accounts = await Account.findAll(this.db, where);\n\n    return accounts[0];\n  }\n\n  async createDataSource(account) {\n    let dataSource = new DataSource();\n\n    const localDatabase = new LocalDatabaseDataSource(account);\n\n    dataSource.add(localDatabase);\n\n    await localDatabase.load(this.db);\n\n    return dataSource;\n  }\n}\n"]}