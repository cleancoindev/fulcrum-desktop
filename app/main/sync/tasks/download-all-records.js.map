{"version":3,"sources":["../../../../src/main/sync/tasks/download-all-records.js"],"names":["DownloadAllRecords","run","account","dataSource","forms","findActiveForms","form","Promise","resolve","reject","load","synchronizer","addTask","taskParams"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AACA;;AAEe,MAAMA,kBAAN,wBAAsC;AAC7CC,KAAN,CAAU,EAACC,OAAD,EAAUC,UAAV,EAAV,EAAiC;AAAA;;AAAA;AAC/B,YAAMC,QAAQ,MAAMF,QAAQG,eAAR,EAApB;;AAEA,WAAK,MAAMC,IAAX,IAAmBF,KAAnB,EAA0B;AACxB,cAAM,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrCH,eAAKI,IAAL,CAAUP,UAAV,EAAsBK,OAAtB;AACD,SAFK,CAAN;;AAIA,cAAKG,YAAL,CAAkBC,OAAlB,CAA0B,yCAAqBN,MAAMA,IAA3B,IAAoC,MAAKK,YAAL,CAAkBE,UAAtD,EAA1B;AACD;;AAED;AACA,YAAKF,YAAL,CAAkBC,OAAlB,CAA0B,6BAAmB,MAAKD,YAAL,CAAkBE,UAArC,CAA1B;AACA,YAAKF,YAAL,CAAkBC,OAAlB,CAA0B,6BAAmB,MAAKD,YAAL,CAAkBE,UAArC,CAA1B;AACA,YAAKF,YAAL,CAAkBC,OAAlB,CAA0B,4BAAkB,MAAKD,YAAL,CAAkBE,UAApC,CAA1B;AACA,YAAKF,YAAL,CAAkBC,OAAlB,CAA0B,iCAAuB,MAAKD,YAAL,CAAkBE,UAAzC,CAA1B;AAf+B;AAgBhC;AAjBkD;kBAAhCb,kB","file":"download-all-records.js","sourcesContent":["import Task from './task';\nimport DownloadRecords from './download-records';\nimport DownloadPhotos from './download-photos';\nimport DownloadVideos from './download-videos';\nimport DownloadAudio from './download-audio';\nimport DownloadSignatures from './download-signatures';\n// import DownloadPhotos from './download-photos';\n\nexport default class DownloadAllRecords extends Task {\n  async run({account, dataSource}) {\n    const forms = await account.findActiveForms();\n\n    for (const form of forms) {\n      await new Promise((resolve, reject) => {\n        form.load(dataSource, resolve);\n      });\n\n      this.synchronizer.addTask(new DownloadRecords({form: form, ...this.synchronizer.taskParams}));\n    }\n\n    // download media here to make sure the tasks are ordered after the records\n    this.synchronizer.addTask(new DownloadPhotos(this.synchronizer.taskParams));\n    this.synchronizer.addTask(new DownloadVideos(this.synchronizer.taskParams));\n    this.synchronizer.addTask(new DownloadAudio(this.synchronizer.taskParams));\n    this.synchronizer.addTask(new DownloadSignatures(this.synchronizer.taskParams));\n  }\n}\n"]}