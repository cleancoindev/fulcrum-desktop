{"version":3,"sources":["../../../src/main/commands/sync.js"],"names":["Sync","run","accounts","fetchAccount","args","org","account","syncLoop","full","fullSync","sync","dataSource","createDataSource","synchronizer","form","Promise","resolve","setTimeout","start"],"mappings":";;AAAA;;;;AACA;;;;;;;;AAEA,MAAMA,IAAN,2BAA2B;AACnBC,KAAN,GAAY;AAAA;;AAAA;AACV,YAAMC,WAAW,MAAM,MAAKC,YAAL,CAAkB,MAAKC,IAAL,CAAUC,GAA5B,CAAvB;;AAEA,WAAK,MAAMC,OAAX,IAAsBJ,QAAtB,EAAgC;AAC9B,cAAM,MAAKK,QAAL,CAAcD,OAAd,EAAuB,MAAKF,IAAL,CAAUI,IAAjC,CAAN;AACD;AALS;AAMX;;AAEKD,UAAN,CAAeD,OAAf,EAAwBG,QAAxB,EAAkC;AAAA;;AAAA;AAChC,YAAMC,OAAO,IAAb;;AAEA,YAAMC,aAAa,MAAM,OAAKC,gBAAL,CAAsBN,OAAtB,CAAzB;;AAEA,aAAOI,IAAP,EAAa;AACX,cAAMG,eAAe,4BAArB;;AAEA,cAAMA,aAAaZ,GAAb,CAAiBK,OAAjB,EAA0B,OAAKF,IAAL,CAAUU,IAApC,EAA0CH,UAA1C,EAAsD,EAACF,QAAD,EAAtD,CAAN;;AAEAA,mBAAW,KAAX;;AAEA,cAAM,IAAIM,OAAJ,CAAY,UAACC,OAAD;AAAA,iBAAaC,WAAWD,OAAX,EAAoB,KAApB,CAAb;AAAA,SAAZ,CAAN;AACD;AAb+B;AAcjC;AAvBwB;;AA0B3B,IAAIhB,IAAJ,GAAWkB,KAAX","file":"sync.js","sourcesContent":["import Command from './command';\nimport Synchronizer from '../sync/synchronizer';\n\nclass Sync extends Command {\n  async run() {\n    const accounts = await this.fetchAccount(this.args.org);\n\n    for (const account of accounts) {\n      await this.syncLoop(account, this.args.full);\n    }\n  }\n\n  async syncLoop(account, fullSync) {\n    const sync = true;\n\n    const dataSource = await this.createDataSource(account);\n\n    while (sync) {\n      const synchronizer = new Synchronizer();\n\n      await synchronizer.run(account, this.args.form, dataSource, {fullSync});\n\n      fullSync = false;\n\n      await new Promise((resolve) => setTimeout(resolve, 10000));\n    }\n  }\n}\n\nnew Sync().start();\n"]}