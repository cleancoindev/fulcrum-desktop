{"version":3,"sources":["../../../src/main/commands/install-plugin.js"],"names":["runCommand","pluginPath","fulcrum","dir","commands","parts","args","url","split","name","length","replace","newPluginPath","join","push","string","console","log","env","task","cli","command","desc","builder","type","required","handler"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;;;;;kBAEe,MAAM;AAAA;AAAA,SAgBnBA,UAhBmB,qBAgBN,aAAY;AACvB,YAAMC,aAAaC,QAAQC,GAAR,CAAY,SAAZ,CAAnB;;AAEA,YAAMC,WAAW,EAAjB;;AAEA,YAAMC,QAAQH,QAAQI,IAAR,CAAaC,GAAb,CAAiBC,KAAjB,CAAuB,GAAvB,CAAd;;AAEA,YAAMC,OAAOJ,MAAMA,MAAMK,MAAN,GAAe,CAArB,EAAwBC,OAAxB,CAAgC,OAAhC,EAAyC,EAAzC,CAAb;;AAEA,YAAMC,gBAAgB,eAAKC,IAAL,CAAUZ,UAAV,EAAsBQ,IAAtB,CAAtB;;AAEAL,eAASU,IAAT,CAAe,aAAYZ,QAAQI,IAAR,CAAaC,GAAI,IAAGK,aAAc,EAA7D;AACAR,eAASU,IAAT,CAAe,MAAKF,aAAc,EAAlC;AACAR,eAASU,IAAT,CAAc,MAAd;;AAEA,YAAMC,SAASX,SAASS,IAAT,CAAc,MAAd,CAAf;;AAEAG,cAAQC,GAAR,CAAY,eAAZ;;AAEA,mCAASF,MAAT,EAAiB,EAACG,wBAAD,EAAjB;;AAEAF,cAAQC,GAAR,CAAY,qBAAZ,EAAmCL,aAAnC;AACD,KAtCkB;AAAA;;AACbO,MAAN,CAAWC,GAAX,EAAgB;AAAA;;AAAA;AACd,aAAOA,IAAIC,OAAJ,CAAY;AACjBA,iBAAS,gBADQ;AAEjBC,cAAM,kBAFW;AAGjBC,iBAAS;AACPhB,eAAK;AACHiB,kBAAM,QADH;AAEHF,kBAAM,uBAFH;AAGHG,sBAAU;AAHP;AADE,SAHQ;AAUjBC,iBAAS,MAAK1B;AAVG,OAAZ,CAAP;AADc;AAaf;;AAdkB,C","file":"install-plugin.js","sourcesContent":["import path from 'path';\nimport { execSync } from 'child_process';\nimport pluginEnv from '../plugin-env';\n\nexport default class {\n  async task(cli) {\n    return cli.command({\n      command: 'install-plugin',\n      desc: 'install a plugin',\n      builder: {\n        url: {\n          type: 'string',\n          desc: 'the URL to a git repo',\n          required: true\n        }\n      },\n      handler: this.runCommand\n    });\n  }\n\n  runCommand = async () => {\n    const pluginPath = fulcrum.dir('plugins');\n\n    const commands = [];\n\n    const parts = fulcrum.args.url.split('/');\n\n    const name = parts[parts.length - 1].replace(/\\.git/, '');\n\n    const newPluginPath = path.join(pluginPath, name);\n\n    commands.push(`git clone ${fulcrum.args.url} ${newPluginPath}`);\n    commands.push(`cd ${newPluginPath}`);\n    commands.push('yarn');\n\n    const string = commands.join(' && ');\n\n    console.log('Installing...');\n\n    execSync(string, {env: pluginEnv});\n\n    console.log('Plugin installed at', newPluginPath);\n  }\n}\n"]}