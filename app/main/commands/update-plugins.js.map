{"version":3,"sources":["../../../src/main/commands/update-plugins.js"],"names":["runCommand","pluginPaths","sync","join","fulcrum","dir","pluginPath","pluginDir","resolve","dirname","commands","push","string","console","log","result","cwd","toString","ex","error","stderr","task","cli","command","desc","handler"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;;;;;kBAEe,MAAM;AAAA;AAAA,SASnBA,UATmB,qBASN,aAAY;AACvB,YAAMC,cAAc,eAAKC,IAAL,CAAU,eAAKC,IAAL,CAAUC,QAAQC,GAAR,CAAY,SAAZ,CAAV,EAAkC,GAAlC,EAAuC,WAAvC,CAAV,CAApB;;AAEA,WAAK,MAAMC,UAAX,IAAyBL,WAAzB,EAAsC;AACpC,cAAMM,YAAY,eAAKC,OAAL,CAAa,eAAKC,OAAL,CAAaH,UAAb,CAAb,CAAlB;;AAEA,cAAMI,WAAW,EAAjB;;AAEAA,iBAASC,IAAT,CAAc,UAAd;AACAD,iBAASC,IAAT,CAAc,MAAd;;AAEA,cAAMC,SAASF,SAASP,IAAT,CAAc,MAAd,CAAf;;AAEAU,gBAAQC,GAAR,CAAY,oBAAZ,EAAkCR,UAAlC;;AAEA,YAAI;AACF,gBAAMS,SAAS,6BAASH,MAAT,EAAiB,EAACI,KAAKT,SAAN,EAAjB,CAAf;AACAM,kBAAQC,GAAR,CAAYC,OAAOE,QAAP,EAAZ;AACAJ,kBAAQC,GAAR,CAAY,qBAAZ;AACD,SAJD,CAIE,OAAOI,EAAP,EAAW;AACXL,kBAAQM,KAAR,CAAc,uBAAd,EAAuCb,UAAvC,EAAmDY,GAAGE,MAAH,CAAUH,QAAV,EAAnD;AACD;AACF;AACF,KAhCkB;AAAA;;AACbI,MAAN,CAAWC,GAAX,EAAgB;AAAA;;AAAA;AACd,aAAOA,IAAIC,OAAJ,CAAY;AACjBA,iBAAS,gBADQ;AAEjBC,cAAM,oBAFW;AAGjBC,iBAAS,MAAKzB;AAHG,OAAZ,CAAP;AADc;AAMf;;AAPkB,C","file":"update-plugins.js","sourcesContent":["import path from 'path';\nimport { execSync } from 'child_process';\nimport glob from 'glob';\n\nexport default class {\n  async task(cli) {\n    return cli.command({\n      command: 'update-plugins',\n      desc: 'update all plugins',\n      handler: this.runCommand\n    });\n  }\n\n  runCommand = async () => {\n    const pluginPaths = glob.sync(path.join(fulcrum.dir('plugins'), '*', 'plugin.js'));\n\n    for (const pluginPath of pluginPaths) {\n      const pluginDir = path.resolve(path.dirname(pluginPath));\n\n      const commands = [];\n\n      commands.push('git pull');\n      commands.push('yarn');\n\n      const string = commands.join(' && ');\n\n      console.log('Updating plugin...', pluginPath);\n\n      try {\n        const result = execSync(string, {cwd: pluginDir});\n        console.log(result.toString());\n        console.log('Plugin updated.\\n\\n');\n      } catch (ex) {\n        console.error('Error updating plugin', pluginPath, ex.stderr.toString());\n      }\n    }\n  }\n}\n"]}