{"version":3,"sources":["../../../src/main/models/account.js"],"names":["Account","tableName","columns","name","column","type","null","userResourceID","_userResourceID","organizationResourceID","_organizationResourceID","organizationName","_organizationName","email","_email","firstName","_firstName","lastName","_lastName","token","_token","findByUserAndOrganization","userID","organizationID","callback","findFirst","user_resource_id","organization_resource_id","findForms","where","findAll","db","account_id","rowID","findProjects","findChoiceLists","findClassificationSets","findRoles","findMemberships","findFirstForm","findFirstRecord","findEachRecord","findEach","findEachBySQL","sql","values","each","findBySQL","all","findActiveForms","deleted_at","projectByResourceID","projectId","findSyncState","findOrCreate","register"],"mappings":"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","file":"account.js","sourcesContent":["import { PersistentObject } from 'minidb';\nimport Project from './project';\nimport ChoiceList from './choice-list';\nimport ClassificationSet from './classification-set';\nimport Form from './form';\nimport Record from './record';\nimport Role from './role';\nimport Membership from './membership';\nimport SyncState from './sync-state';\n\nexport default class Account {\n  static get tableName() {\n    return 'accounts';\n  }\n\n  static get columns() {\n    return [\n      { name: 'userResourceID', column: 'user_resource_id', type: 'string', null: false },\n      { name: 'organizationResourceID', column: 'organization_resource_id', type: 'string', null: false },\n      { name: 'organizationName', column: 'organization_name', type: 'string', null: false },\n      { name: 'email', column: 'email', type: 'string', null: false },\n      { name: 'firstName', column: 'first_name', type: 'string' },\n      { name: 'lastName', column: 'last_name', type: 'string' },\n      { name: 'lastSyncPhotos', column: 'last_sync_photos', type: 'datetime' },\n      { name: 'lastSyncVideos', column: 'last_sync_videos', type: 'datetime' },\n      { name: 'lastSyncAudio', column: 'last_sync_audio', type: 'datetime' },\n      { name: 'lastSyncSignatures', column: 'last_sync_signatures', type: 'datetime' },\n      { name: 'lastSyncChangesets', column: 'last_sync_changesets', type: 'datetime' },\n      { name: 'token', column: 'token', type: 'string' }\n    ];\n  }\n\n  get userResourceID() {\n    return this._userResourceID;\n  }\n\n  get organizationResourceID() {\n    return this._organizationResourceID;\n  }\n\n  get organizationName() {\n    return this._organizationName;\n  }\n\n  get email() {\n    return this._email;\n  }\n\n  get firstName() {\n    return this._firstName;\n  }\n\n  get lastName() {\n    return this._lastName;\n  }\n\n  get token() {\n    return this._token;\n  }\n\n  static findByUserAndOrganization(userID, organizationID, callback) {\n    return Account.findFirst({user_resource_id: userID,\n                              organization_resource_id: organizationID}, callback);\n  }\n\n  findForms(where) {\n    return Form.findAll(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findProjects(where) {\n    return Project.findAll(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findChoiceLists(where) {\n    return ChoiceList.findAll(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findClassificationSets(where) {\n    return ClassificationSet.findAll(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findRoles(where) {\n    return Role.findAll(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findMemberships(where) {\n    return Membership.findAll(this.db, {...where, account_id: this.rowID}, 'email ASC');\n  }\n\n  findFirstForm(where) {\n    return Form.findFirst(this.db, {...where, account_id: this.rowID}, 'name ASC');\n  }\n\n  findFirstRecord(where) {\n    return Record.findFirst(this.db, {...where, account_id: this.rowID});\n  }\n\n  findEachRecord(where, callback) {\n    return Record.findEach(this.db, {where: {...where, account_id: this.rowID}}, callback);\n  }\n\n  findEachBySQL(sql, values, callback) {\n    return this.db.each(sql, values, callback);\n  }\n\n  findBySQL(sql, values, callback) {\n    return this.db.all(sql, values, callback);\n  }\n\n  findActiveForms(where) {\n    return Form.findAll(this.db, {...where, account_id: this.rowID, deleted_at: null}, 'name ASC');\n  }\n\n  projectByResourceID(projectId) {\n    return Project.findFirst(this.db, {account_id: this.rowID});\n  }\n\n  findSyncState(where) {\n    return SyncState.findOrCreate(this.db, {...where, account_id: this.rowID});\n  }\n}\n\nPersistentObject.register(Account);\n"]}